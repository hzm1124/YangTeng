// ==UserScript==
// @name         AutoteileDirekt爬虫-Menu
// @namespace    https://github.com/lennon1124/YangTeng
// @version      2024.03.13
// @description  Crawler
// @author       Lennon
// @match        *://www.autoteiledirekt.de/suche.html?*
// @icon         https://www.autoteiledirekt.de/favicon.ico
// @grant        none
// ==/UserScript==

(function() {
    'use strict';

    window.onload = function() {
        // parameter
        let dict_url = {"1": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler", "2": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=2", "3": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=3", "4": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=4", "5": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=5", "6": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=6", "7": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=7", "8": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=8", "9": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=9", "10": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=10", "11": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=11", "12": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=12", "13": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=13", "14": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=14", "15": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=15", "16": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=16", "17": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=17", "18": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=18", "19": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=19", "20": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=20", "21": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=21", "22": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=22", "23": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=23", "24": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=24", "25": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=25", "26": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=26", "27": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=27", "28": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=28", "29": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=29", "30": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=30", "31": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=31", "32": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=32", "33": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=33", "34": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=34", "35": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=35", "36": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=36", "37": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=37", "38": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=38", "39": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=39", "40": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=40", "41": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=41", "42": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=42", "43": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=43", "44": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=44", "45": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=45", "46": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=46", "47": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=47", "48": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=48", "49": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=49", "50": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=50", "51": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=51", "52": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=52", "53": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=53", "54": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=54", "55": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=55", "56": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=56", "57": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=57", "58": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=58", "59": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=59", "60": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=60", "61": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=61", "62": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=62", "63": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=63", "64": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=64", "65": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=65", "66": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=66", "67": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=67", "68": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=68", "69": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=69", "70": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=70", "71": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=71", "72": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=72", "73": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=73", "74": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=74", "75": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=75", "76": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=76", "77": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=77", "78": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=78", "79": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=79", "80": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=80", "81": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=81", "82": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=82", "83": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=83", "84": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=84", "85": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=85", "86": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=86", "87": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=87", "88": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=88", "89": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=89", "90": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=90", "91": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=91", "92": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=92", "93": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=93", "94": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=94", "95": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=95", "96": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=96", "97": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=97", "98": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=98", "99": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=99", "100": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=100", "101": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=101", "102": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=102", "103": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=103", "104": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=104", "105": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=105", "106": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=106", "107": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=107", "108": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=108", "109": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=109", "110": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=110", "111": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=111", "112": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=112", "113": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=113", "114": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=114", "115": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=115", "116": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=116", "117": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=117", "118": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=118", "119": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=119", "120": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=120", "121": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=121", "122": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=122", "123": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=123", "124": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=124", "125": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=125", "126": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=126", "127": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=127", "128": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=128", "129": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=129", "130": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=130", "131": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=131", "132": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=132", "133": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=133", "134": "https://www.autoteiledirekt.de/suche.html?keyword=Leerlaufregler&pg=134"};

        let list_param = window.location.href.split('?')[1].split('&');
        let param_pg = 1;
        for(let i=0; i<list_param.length; i++) {
            if(list_param[i].startsWith('pg=')) {
                param_pg = parseInt(list_param[i].split('pg=')[1]);
            }
        }

        window.scrollTo(0, document.body.scrollHeight);
        console.log('\n\n\n= = = = = = = = = = = = = = =');
        console.log('Crawler Log 1: Start');

        // array
        let array_data = new Array();
        let list_part = document.querySelectorAll('div.product-card__image>span');
        for(let i=0; i<list_part.length; i++) {
            array_data[i] = {};
            array_data[i]['Page'] = param_pg;
            array_data[i]['No.'] = i + 1;
            array_data[i]['Url'] = list_part[i].getAttribute('data-link').trim();
        }
        console.log('Crawler Log 2: Array');

        // json
        let json_data = JSON.stringify(array_data);
        console.log('Crawler Log 3: Json');

        // blob
        let blob_data = new Blob([json_data], {type: 'text/plain'});
        let blob_url = URL.createObjectURL(blob_data);
        let blob_a = document.createElement('a');
        blob_a.href = blob_url;
        blob_a.download = String(param_pg) + '.txt';
        blob_a.click();
        URL.revokeObjectURL(blob_url);
        console.log('Crawler Log 4: End');
        console.log('= = = = = = = = = = = = = = =\n\n\n');

        // next
        window.location.href = dict_url[String(param_pg+1)];
    }
})();