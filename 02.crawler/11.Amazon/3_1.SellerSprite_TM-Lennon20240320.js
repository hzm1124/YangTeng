// ==UserScript==
// @name         SellerSprite爬虫
// @namespace    https://github.com/lennon1124/YangTeng
// @version      2024.03.20
// @description  Crawler
// @author       Lennon
// @match        *://www.sellersprite.com/*
// @icon         https://www.sellersprite.com/favicon.ico
// @grant        none
// ==/UserScript==

(function() {
    'use strict';

    window.onload = function() {
        // parameter
        let dict_url = {"1": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CF56YD1C%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=1", "2": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C7BMYGJJ%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=2", "3": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0BCWDNSVC%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=3", "4": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CJY51879%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=4", "5": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH185YP9%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=5", "6": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH1995V8%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=6", "7": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH1878GQ%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=7", "8": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0BFCTNHZF%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=8", "9": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07ZCRFYLG%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=9", "10": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09283PZQY%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=10", "11": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B01EENLX18%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=11", "12": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CKNYYS6B%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=12", "13": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C78H6FHN%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=13", "14": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C89Q29H3%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=14", "15": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH16CM6J%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=15", "16": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH1677KP%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=16", "17": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C4KS8YD6%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=17", "18": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B082P811XC%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=18", "19": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B08X6HVX2P%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=19", "20": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09282Z1DD%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=20", "21": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07SQ76QMY%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=21", "22": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09282P1H1%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=22", "23": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07SQ6Y9MD%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=23", "24": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C4T7Z733%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=24", "25": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CLP94916%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=25", "26": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07SQ6GCXS%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=26", "27": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07P7J7VPG%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=27", "28": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH18XBM2%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=28", "29": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0BCWCPH19%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=29", "30": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09FXDZ5ZB%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=30", "31": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CF55J7HK%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=31", "32": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C4KHRFWS%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=32", "33": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CHJ4RJFF%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=33", "34": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH17T3B7%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=34", "35": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07DLK9VFY%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=35", "36": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CNGG6YFR%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=36", "37": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CPVG4L9S%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=37", "38": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07JB82RPD%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=38", "39": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CJYDJNGP%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=39", "40": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B08YJHKZ5H%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=40", "41": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CB6K4TL6%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=41", "42": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C4T2Z4YC%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=42", "43": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CF51VBKG%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=43", "44": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C4L88M65%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=44", "45": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09283NFDK%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=45", "46": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07B9WNPJ9%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=46", "47": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CJYC78GR%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=47", "48": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B00IPCFKY6%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=48", "49": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C6LG616J%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=49", "50": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07L2M7CWL%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=50", "51": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CWZVYYX2%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=51", "52": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09VGQLVBL%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=52", "53": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B08M3HS3QF%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=53", "54": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C4H2MD44%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=54", "55": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH195B5Z%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=55", "56": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C6LJZ877%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=56", "57": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07JC24V43%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=57", "58": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09G99F8Q1%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=58", "59": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH186B6N%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=59", "60": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B06XHPZ17V%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=60", "61": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B000C2OBMY%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=61", "62": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07X2J5JDR%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=62", "63": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09YYGVHPZ%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=63", "64": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C4LB8XHH%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=64", "65": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CB8NKVYB%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=65", "66": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07SQ7SWG5%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=66", "67": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CPJ947P7%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=67", "68": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B08X6FZ63Q%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=68", "69": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH18FK97%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=69", "70": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09YYRPMXC%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=70", "71": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09282TG24%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=71", "72": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0B756RHQM%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=72", "73": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CP3RFT23%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=73", "74": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09282CJM2%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=74", "75": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CF4GN366%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=75", "76": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B08538T4CG%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=76", "77": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CJ36HP8F%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=77", "78": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CJX257LC%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=78", "79": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CB6L5V8K%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=79", "80": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09282K9K5%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=80", "81": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B019DTLTX0%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=81", "82": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH19JHH4%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=82", "83": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH1794XN%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=83", "84": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CH16FJ43%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=84", "85": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09281P3WJ%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=85", "86": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09283XKC7%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=86", "87": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09JWJXYB6%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=87", "88": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B088WKGPDB%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=88", "89": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09G93JZKH%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=89", "90": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CHY5RW21%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=90", "91": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CC8TCRJK%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=91", "92": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09283PV9V%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=92", "93": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0C4L7H4YJ%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=93", "94": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B0CCS1DT59%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=94", "95": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09G96W22W%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=95", "96": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B07JB91JL7%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=96", "97": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09283FQN1%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=97", "98": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B08RC3C3LF%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=98", "99": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B081H4MG99%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=99", "100": "https://www.sellersprite.com/v3/competitor-lookup?market=US&monthName=bsr_sales_nearly&asins=%5B%22B09282GCD7%22%5D&page=1&nodeIdPaths=%5B%5D&symbolFlag=true&size=100&order%5Bfield%5D=total_units&order%5Bdesc%5D=true&Lennon_Index=100"};

        let list_param = window.location.href.split('?')[1].split('&');
        let param_lennon_index;
        let asin;
        for(let i=0; i<list_param.length; i++) {
            if(list_param[i].startsWith('Lennon_Index=')) {
                param_lennon_index = parseInt(list_param[i].split('Lennon_Index=')[1]);
            }
            else if(list_param[i].startsWith('asins=%5B%22')) {
                asin = list_param[i].split('asins=%5B%22')[1].split('%22%5D')[0];
            }
        }

        window.scrollTo(0, document.body.scrollHeight);
        console.log('\n\n\n= = = = = = = = = = = = = = =');
        console.log('Crawler Log 1: Start');

        if(document.querySelectorAll('div.content>p')[0].innerText.trim() == '很抱歉，暂无结果！') {
            window.location.href = dict_url[String(param_lennon_index+1)];
        }

        // array
        let array_data = new Array();
        array_data[0] = {};
        array_data[0]['ASIN'] = asin;

        let list_tr = document.querySelectorAll('div.el-table__body-wrapper.is-scrolling-left>table>tbody>tr');
        let index_part;
        for(let i=0; i<list_tr.length; i+=2) {
            if(list_tr[i].querySelectorAll('td.el-table_1_column_4.table-info.el-table__cell>div>div>div')[1].innerText.trim().includes('ASIN: ' + asin)) {
                index_part = i;
            }
        }
        
        array_data[0]['标识'] = ''
        let list_div = list_tr[index_part].querySelectorAll('td')[2].querySelectorAll('div>div.tags');
        for(let i=0; i<list_div.length; i++) {
            array_data[0]['标识'] += list_div[i].innerText.trim() + ';';
        }
        while(array_data[0]['标识'][0] == ';') {
            array_data[0]['标识'] = array_data[0]['标识'].substring(1, array_data[0]['标识'].length);
        }
        while(array_data[0]['标识'][array_data[0]['标识'].length-1] == ';') {
            array_data[0]['标识'] = array_data[0]['标识'].substring(0, array_data[0]['标识'].length-1);
        }

        array_data[0]['父ASIN'] = list_tr[index_part].querySelectorAll('td')[3].querySelectorAll('div>div>div')[2].querySelector('span.text-muted').innerText.split(':')[1].trim();
        array_data[0]['品牌'] = list_tr[index_part].querySelectorAll('td')[3].querySelectorAll('div>div>div')[3].querySelector('div').innerText.trim();
        array_data[0]['品牌链接'] = list_tr[index_part].querySelectorAll('td')[3].querySelectorAll('div>div>div')[3].querySelectorAll('a')[1].getAttribute('href').trim();
        array_data[0]['大类BSR排名'] = list_tr[index_part].querySelectorAll('td')[4].querySelectorAll('div>div>div')[0].innerText.trim();
        array_data[0]['近7天BSR增长数'] = list_tr[index_part].querySelectorAll('td')[4].querySelectorAll('div>div>div')[1].innerText.trim();
        array_data[0]['近7天BSR增长率'] = list_tr[index_part].querySelectorAll('td')[4].querySelectorAll('div>div>div')[2].innerText.trim();
        array_data[0]['父体近30天总销量'] = list_tr[index_part].querySelectorAll('td')[6].querySelectorAll('div>div>div')[0].innerText.trim();
        array_data[0]['父体近30天销量增长率'] = list_tr[index_part].querySelectorAll('td')[6].querySelectorAll('div>div>div')[1].innerText.trim();
        array_data[0]['父体近30天总销售额'] = list_tr[index_part].querySelectorAll('td')[7].querySelector('div>div>div').innerText.trim();
        array_data[0]['子体近一个月的销量'] = list_tr[index_part].querySelectorAll('td')[8].querySelector('div>div>span').innerText.trim();
        array_data[0]['子体近一个月的预估销售额'] = list_tr[index_part].querySelectorAll('td')[8].querySelector('div>div>div').innerText.trim();
        array_data[0]['变体数'] = list_tr[index_part].querySelectorAll('td')[9].querySelector('div>div>span').innerText.trim();
        array_data[0]['最新售价 (BuyBox)'] = list_tr[index_part].querySelectorAll('td')[10].querySelectorAll('div>div>div>div')[0].innerText.trim();
        array_data[0]['最新Q&A数'] = list_tr[index_part].querySelectorAll('td')[10].querySelectorAll('div>div>div>div')[1].innerText.trim();
        array_data[0]['Listing的最新评分数'] = list_tr[index_part].querySelectorAll('td')[11].querySelectorAll('div>div>div')[0].innerText.trim();
        array_data[0]['Listing近30天的新增评分数'] = list_tr[index_part].querySelectorAll('td')[11].querySelectorAll('div>div>div')[1].innerText.trim();
        array_data[0]['Listing的最新评分值'] = list_tr[index_part].querySelectorAll('td')[12].querySelectorAll('div>div>div')[0].innerText.trim();
        array_data[0]['月度留评率'] = list_tr[index_part].querySelectorAll('td')[12].querySelectorAll('div>div>div')[1].innerText.trim();
        array_data[0]['FBA运费'] = list_tr[index_part].querySelectorAll('td')[13].innerText.split('\n')[0].trim();
        array_data[0]['毛利率'] = list_tr[index_part].querySelectorAll('td')[13].innerText.split('\n')[1].trim();
        array_data[0]['上架时间_1'] = list_tr[index_part].querySelectorAll('td')[14].querySelector('div>span').innerText.trim();
        array_data[0]['上架时间_2'] = list_tr[index_part].querySelectorAll('td')[14].querySelector('div>div>span').innerText.trim();
        array_data[0]['配送'] = list_tr[index_part].querySelectorAll('td')[15].querySelector('div>div').innerText.trim();

        array_data[0]['类目路径_1'] = '';
        list_div = list_tr[index_part+1].querySelectorAll('td>div>div>div>div>div>div');
        let list_a = list_div[0].querySelectorAll('span>span>a.el-tooltip.type');
        for(let i=0; i<list_a.length; i++) {
            array_data[0]['类目路径_1'] += list_a[i].innerText.trim() + ' -> ';
        }
        array_data[0]['类目路径_1'] = array_data[0]['类目路径_1'].substring(0, array_data[0]['类目路径_1'].length-4);

        array_data[0]['类目路径_2'] = '';
        let list_span = list_div[1].querySelectorAll('div')[0].querySelectorAll('span>span>span>span');
        for(let i=0; i<list_span.length; i++) {
            array_data[0]['类目路径_2'] += list_span[i].innerText.trim() + ' -> ';
        }
        array_data[0]['类目路径_2'] = array_data[0]['类目路径_2'].substring(0, array_data[0]['类目路径_2'].length-4);

        array_data[0]['小类目'] = '';
        if(array_data[0]['类目路径_2'] != '') {
            let list_div_1 = list_div[1].querySelectorAll('div')[1].querySelectorAll('div');
            for(let i=0; i<list_div_1.length; i++) {
                array_data[0]['小类目'] += list_div_1[i].querySelector('span').innerText.trim() + ' - ' + list_div_1[i].querySelector('a').innerText.trim() + ' - ' + list_div_1[i].querySelector('a').getAttribute('href').trim() + '\n';
            }
            array_data[0]['小类目'] = array_data[0]['小类目'].trim();
        }

        list_span = list_div[2].querySelectorAll('span');
        let offset = 0;
        array_data[0]['重量'] = list_span[0].innerText.split(':')[1].trim();
        if(array_data[0]['重量'] == '--') {
            offset++;
        }

        array_data[0]['体积'] = list_span[2-offset].innerText.split(':')[1].trim();
        if(array_data[0]['体积'].includes('--')) {
            offset++;
        }

        array_data[0]['LQS'] = list_span[5-offset].innerText.split(':')[1].trim();
        if(array_data[0]['LQS'] == '--') {
            offset++;
        }

        array_data[0]['卖家数'] = list_span[7-offset].innerText.split(':')[1].trim();
        if(list_span.length > 10-offset) {
            array_data[0]['BuyBox卖家'] = list_span[10-offset].innerText.split(':')[1].trim();
        }
        else {
            array_data[0]['BuyBox卖家'] = '';
        }
        if(list_span.length > 12-offset) {
            array_data[0]['BuyBox'] = list_span[12-offset].innerText.trim();
        }
        else {
            array_data[0]['BuyBox'] = '';
        }
        console.log('Crawler Log 2: Array');

        // json
        let json_data = JSON.stringify(array_data);
        console.log('Crawler Log 3: Json');

        // blob
        let blob_data = new Blob([json_data], {type: 'text/plain'});
        let blob_url = URL.createObjectURL(blob_data);
        let blob_a = document.createElement('a');
        blob_a.href = blob_url;
        blob_a.download = String(param_lennon_index) + '.txt';
        blob_a.click();
        URL.revokeObjectURL(blob_url);
        console.log('Crawler Log 4: End');
        console.log('= = = = = = = = = = = = = = =\n\n\n');

        // next
        window.location.href = dict_url[String(param_lennon_index+1)];
    }
})();